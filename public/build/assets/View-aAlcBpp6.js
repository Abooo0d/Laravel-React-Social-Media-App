import{r as o,u as h,a as w,j as e,b as A,R as k,c as N,d as F,H as I}from"./app-D8ApISFC.js";import{B as H,a as v,M as S,F as E,A as M}from"./AuthenticatedLayout-BWu7Fzt5.js";import{F as z}from"./index-CmLoXGn-.js";import"./Spinner-WIpfGoCI.js";import"./Buttons-D6eagE2q.js";import"./TextInput-4JU2n0Cb.js";import"./switch-CeXg4hJT.js";import"./keyboard-COk9tFWf.js";import"./use-sync-refs-B2uBAqz-.js";const R=()=>{const[s,r]=o.useState(""),n=o.useRef(null),{currentAIChat:t,setCurrentAIChat:a,setIsLoading:d,setAIChats:m}=h(),{setErrors:b}=w(),y=()=>{const x=n.current;x&&(x.style.height="40px",x.style.height=`${x.scrollHeight}px`)},C=()=>{if(!s)return;let x={body:s,id:"",attachments:[],created_at:"now",chat_id:"",from:""};a(l=>({...l,messages:[{id:"waiting",from:"AI"},x,...(l==null?void 0:l.messages)||[]]})),d(!0),r(""),A.post(route("AIChat.newMessage",{message:s,chat_id:t!=null&&t.id?t==null?void 0:t.id:""})).then(l=>{var c,p;const u=(c=l==null?void 0:l.data)==null?void 0:c.chat,g=(p=l==null?void 0:l.data)==null?void 0:p.message;console.log(l.data),u?(a(i=>{var j;return{...u,messages:(j=i==null?void 0:i.messages)==null?void 0:j.map(f=>f.id=="waiting"?g:f)}}),m(i=>[u,...i])):a(i=>{var j;return{...i,messages:(j=i==null?void 0:i.messages)==null?void 0:j.map(f=>(f==null?void 0:f.id)=="waiting"?g:f)}}),d(!1)}).catch(l=>{var u,g;d(!1),console.log(l),a(c=>{var p;return{...c,messages:(p=c==null?void 0:c.messages)==null?void 0:p.map(i=>(i==null?void 0:i.id)=="waiting"?{isError:!0,from:"AI"}:i)}}),b([((g=(u=l==null?void 0:l.response)==null?void 0:u.data)==null?void 0:g.message)||"Some Thing Went Wrong"])})};return o.useEffect(()=>{y()},[s]),o.useEffect(()=>{y()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-[134px] left-0 w-full h-[50px] bg-gradient-to-t from-homeFeed via-homeFeed/80 to-transparent duration-200 "}),e.jsx("div",{className:"w-full flex justify-center items-center mb-4",children:e.jsxs("div",{className:"w-full max-w-[90%] rounded-[30px] bg-gray-900/50 backdrop-blur-sm border-solid border-[1px] border-gray-500/50 flex justify-start items-end px-4 py-2 duration-200",children:[e.jsx("div",{className:"flex justify-start items-center gap-2",children:e.jsx("button",{className:"w-[30px] h-[40px] rounded-md hover:bg-gray-900 bg-transparent hover:border-gray-500/50 border-transparent border-[1px] border-solid hover:border-solid duration-200 flex justify-center items-center text-gray-500",children:e.jsx(z,{})})}),e.jsx("textarea",{ref:n,placeholder:"What Are Thinking?",value:s,onChange:x=>r(x.target.value),className:"bg-transparent border-none outline-none ring-0 focus:ring-0 w-full max-h-[180px] duration-200 resize-none text-gray-300 overflow-auto"}),e.jsx("button",{className:"w-[30px] h-[40px] rounded-md hover:bg-gray-900 bg-transparent hover:border-gray-500/50 border-transparent border-[1px] border-solid hover:border-solid duration-200 flex justify-center items-center text-gray-500",onClick:()=>{C()},children:e.jsx(H,{})})]})})]})},_=()=>e.jsxs("div",{className:"w-full flex justify-start items-center pl-8 gap-4 z-10 ",children:[e.jsx(v,{className:"w-[25px] h-[25px] text-gray-400 z-10"}),e.jsxs("span",{className:"flex size-3 m-4 relative",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-sky-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex size-3 rounded-full bg-sky-500"})]})]}),L=k.memo(({message:s,show:r,isLast:n})=>{const t=o.useRef(null),[a,d]=o.useState(0);return o.useEffect(()=>{if(t.current){const m=t.current.scrollHeight;d(m)}},[s]),e.jsx("div",{className:"w-full h-fit relative duration-500",children:(s==null?void 0:s.from)=="AI"?e.jsx(e.Fragment,{children:s!=null&&s.isError?e.jsx("div",{className:"bg-red-500/40 border-[1px] border-solid border-red-500 flex justify-start items-center py-2 px-4 mt-2 rounded-md break-words w-fit",children:e.jsx("h2",{className:"text-gray-300",children:"Some Thing Wrong Happened, Please Try Again Latter"})}):e.jsx("div",{className:`overflow-hidden duration-500 ${n&&"messageCard duration-500"}`,children:e.jsx("div",{className:"text-gray-300 w-full AI-response duration-500",ref:t,style:{height:a?`${a}px`:"0px",overflow:"hidden",transition:"height 1s ease"},children:(s==null?void 0:s.id)=="waiting"?e.jsx(_,{}):e.jsx(S,{content:s==null?void 0:s.body})})})}):e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"w-[600px] max-w-[80%] h-[1px] bg-gray-600/20 mx-auto my-[20px]"}),e.jsx("div",{className:"w-full flex justify-end items-center gap-4 pr-4",children:e.jsx("div",{className:"max-w-[60%] w-fit h-fit rounded-lg bg-gray-800/30 text-gray-300 border-solid border-gray-600/50 border-[1px] flex justify-center items-center px-4 py-2 ",children:s==null?void 0:s.body})})]})})}),T=()=>{var t;const{currentAIChat:s,isLoading:r}=h(),{user:n}=N();return e.jsx("div",{className:"flex justify-start items-center flex-col-reverse max-w-[90%] max-h-[calc(100vh-200px)] h-full w-full overflow-auto px-4 py-2 pb-[40px]",children:((t=s==null?void 0:s.messages)==null?void 0:t.length)>0?e.jsx(e.Fragment,{children:s.messages.map((a,d)=>e.jsx(L,{message:a,show:!(d>=s.messages.length-1),isLast:d===s.messages.length-1},d))}):e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsxs("h2",{className:"text-3xl font-[500] bg-gradient-to-r from-gray-300 via-emerald-500 to-sky-500 bg-clip-text text-transparent",children:["Hello,",n==null?void 0:n.name]})})})},$=()=>e.jsxs("div",{className:"order-2 relative bg-gray-300 dark:bg-homeFeed z-[10] min-h-full md:max-h-barHeight max-h-[calc(100vh-120px)] flex-1 overflow-hidden flex flex-col justify-between items-center",children:[e.jsx(T,{}),e.jsx(R,{})]}),B=({chat:s,setShow:r})=>{var t;const{setCurrentAIChat:n}=h();return e.jsx("div",{className:"min-h-[50px] w-[230px] relative flex items-center justify-start gap-2 py-2 px-4 text-gray-400 duration-200 rounded-md hover:bg-gray-800/60 cursor-pointer",onClick:()=>{r(!1),n(s)},children:e.jsxs("h3",{className:"text-[15px] w-full text-nowrap overflow-hidden",children:[((t=s==null?void 0:s.name)==null?void 0:t.length)>16?s.name.substr(0,16)+"...":s==null?void 0:s.name,e.jsxs("div",{className:"absolute h-full right-[4px] top-0 flex flex-col items-end justify-center",children:[e.jsx("span",{className:"text-[12px] text-gray-500",children:s==null?void 0:s.created_at.split(" ")[0]}),e.jsx("span",{className:"text-[12px] text-gray-500",children:s==null?void 0:s.created_at.split(" ")[1]})]})]})})},P=({setShow:s})=>{const{AIChats:r}=h();return e.jsx("div",{children:(r==null?void 0:r.length)>0?e.jsx(e.Fragment,{children:r.map((n,t)=>e.jsx(B,{chat:n,setShow:s},t))}):e.jsx("div",{className:"w-full text-gray-500 text-center p-4",children:"No Chats In The History Yet"})})},W=()=>{const[s,r]=o.useState(!1),{setCurrentAIChat:n}=h();return e.jsxs("div",{className:"relative z-[100]",children:[e.jsx("button",{className:`p-[4px] cursor-pointer z-[101] absolute top-[100px] duration-200 backdrop-blur-lg w-[40px] h-[50px] text-sm flex justify-center items-center flex-col bg-gray-800/80 border-[1px] border-gray-600/70 border-solid rounded-r-md border-l-0 text-gray-400
              ${s?"left-[270px]":"left-[0px]"}`,onClick:()=>{r(t=>!t)},children:e.jsx(v,{className:"w-[20px] h-[20px]"})}),e.jsxs("div",{className:`absolute z-[100] top-0 max-h-barHeight h-full w-[270px] flex flex-col gap-2 py-2 bg-gray-900 px-2 duration-200 border-r-solid border-r-gray-500/50 border-r-[1px]
            ${s?"left-0 ":"left-[-270px]"}`,children:[e.jsx("div",{className:"flex w-full justify-between items-center h-fit py-1 px-4 ",children:e.jsx("h2",{className:"block text-xl font-bold dark:text-gray-300 cursor-default ",children:"AI Chat:"})}),e.jsxs("button",{className:"bg-gray-900 flex justify-between items-center rounded-md text-gray-300 duration-200 hover:bg-gray-800 px-4 py-2",onClick:()=>{n(null),r(!1)},children:["New Chat",e.jsx(E,{})]}),e.jsxs("div",{className:"flex flex-col gap-2 flex-1 px-4 py-2",children:[e.jsx("h2",{className:"block text-xl font-bold dark:text-gray-300 cursor-default ",children:"History:"}),e.jsx(P,{setShow:r})]}),e.jsx("div",{className:"flex-1 overflow-auto flex justify-start items-start"})]})]})},U=({auth:s,chats:r})=>{const{setUser:n}=N(),{setAIChats:t}=h(),{flash:a,errors:d}=F().props,{setErrors:m,setSuccessMessage:b}=w();return o.useEffect(()=>{n(s.user)},[s]),o.useEffect(()=>{t(r)},[r]),o.useEffect(()=>{a!=null&&a.success&&b(a.success),a!=null&&a.error&&m([a.error])},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx("title",{children:"Chatter"}),e.jsx("link",{rel:"icon",type:"image/svg+xml",href:"/Logo_ico.ico"})]}),e.jsxs("div",{className:"flex min-h-barHeight overflow-hidden",children:[e.jsx($,{}),e.jsx(W,{})]})]})};U.layout=s=>e.jsx(M,{children:s});export{U as default};
